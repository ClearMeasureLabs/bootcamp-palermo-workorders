%% C4 Container Diagram - IntegrationTests (test runner process)
%% Process head: IntegrationTests

C4Container
    title Container Diagram - IntegrationTests

    Container_Boundary(integration_tests, "IntegrationTests") {
        Container(test_host, "TestHost", "WebApplicationFactory", "In-memory server")
        Container(integrated_base, "IntegratedTestBase", "NUnit", "Test base with DB")
        Container(db_tests, "DatabaseTests", "EF Core", "DataAccess + LocalDB/SQLite")
        Container(handler_tests, "Handler Tests", "MediatR handlers", "StateCommand, Query handlers")
        ContainerDb(db, "Test Database", "LocalDB / SQLite", "ZDataLoader, DatabaseEmptier")
    }

    Rel(test_host, db, "ConnectionString")
    Rel(integrated_base, test_host, "Uses")
    Rel(db_tests, db, "EF Core")
    Rel(handler_tests, test_host, "Via IBus")
